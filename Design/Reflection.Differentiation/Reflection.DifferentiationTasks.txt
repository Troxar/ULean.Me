Практика «Дифференцирование»

C# − гибкий язык, на котором можно делать удивительные вещи. Например, на нем вполне можно написать систему компьютерной алгебры.
В частности, в этом задании вы, используя LINQ Expressions, реализуете символьное (не численное) дифференцирование функции.
Для прохождения тестов нужно уметь работать с выражениями, в которых встречается сложение, умножение, а также функции синуса и косинуса.
На попытки продифференцировать не поддерживаемые функции или синтаксические конструкции нужно выбрасывать исключение с понятным сообщением об ошибке, достаточном для локализации проблемы.
Постарайтесь организовать код так, чтобы добавлять в него поддержку новых функций и операторов было как можно понятнее и проще.